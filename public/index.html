<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Pulse Document Comparison</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Geist:wght@400;500;600;700;800&family=Inria+Serif:wght@400;600;700;800&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header class="navbar">
      <div class="navbar-inner">
        <a class="brand" href="/" aria-label="Pulse Document Comparison home">
          <span class="brand-mark" aria-hidden="true">
            <svg viewBox="0 0 20 20" width="20" height="20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path
                d="M4 4h3v3H4V4Zm5 0h3v3H9V4Zm5 0h2v3h-2V4ZM4 9h3v3H4V9Zm5 0h3v3H9V9Zm5 0h2v3h-2V9ZM4 14h3v2H4v-2Zm5 0h3v2H9v-2Zm5 0h2v2h-2v-2Z"
                fill="currentColor"
              />
            </svg>
          </span>
          <span class="brand-name">Pulse</span>
          <span class="brand-subtitle">Document Comparison</span>
        </a>

        <div class="nav-actions"></div>
      </div>

      <div class="tabs-inner" role="navigation" aria-label="Sections">
        <a class="tab is-active" href="#upload" id="tab-upload">Upload</a>
        <a class="tab" href="#summary" id="tab-summary" data-requires-results="true">Summary</a>
        <a class="tab" href="#insights" id="tab-insights" data-requires-results="true">Insights</a>
        <a class="tab" href="#inline" id="tab-inline" data-requires-results="true">Inline diff</a>
        <a class="tab" href="#side-by-side" id="tab-side" data-requires-results="true">Side-by-side</a>
      </div>
    </header>

    <main class="page">
      <div class="layout">
        <div class="content">
          <header class="page-header">
            <p class="eyebrow">Pulse API</p>
            <h1>Document Version Comparison</h1>
            <p class="subhead">
              Upload two documents to extract structured content with Pulse and review differences
            </p>
          </header>

          <section class="card" id="upload" aria-label="Upload documents">
            <div class="card-header">
              <div>
                <h2>Upload</h2>
                <p class="muted">PDFs, Word docs, images, and other Pulse-supported formats.</p>
              </div>
            </div>

            <form id="compare-form" class="grid">
              <div class="input-card input-wide">
                <h3>Comparison options</h3>
                <p class="muted">Choose a diff mode and optionally extract structured fields.</p>

                <div class="options">
                  <div class="option">
                    <div class="option-label">Diff mode</div>
                    <div class="segmented" role="radiogroup" aria-label="Diff mode">
                      <label class="segmented-item">
                        <input type="radio" name="diff_mode" value="words" checked />
                        <span>Word</span>
                      </label>
                      <label class="segmented-item">
                        <input type="radio" name="diff_mode" value="lines" />
                        <span>Line</span>
                      </label>
                    </div>
                  </div>

                  <div class="option">
                    <label class="check">
                      <input id="structured-enabled" type="checkbox" />
                      <span>
                        <span class="check-title">Structured extraction</span>
                        <span class="muted">Extract and compare fields using a JSON schema.</span>
                      </span>
                    </label>
                  </div>
                </div>

                <div id="structured-config" class="structured hidden" aria-label="Structured extraction settings">
                  <div class="structured-row">
                    <div>
                      <div class="option-label">Preset</div>
                      <select id="structured-preset" class="select">
                        <option value="custom">Custom</option>
                        <option value="contract">Contract (basic)</option>
                        <option value="invoice">Invoice (basic)</option>
                      </select>
                    </div>
                    <div>
                      <div class="option-label">Schema prompt (optional)</div>
                      <input
                        id="structured-prompt"
                        class="text-input"
                        type="text"
                        placeholder="e.g. Focus on payment terms, dates, and parties. Format dates as YYYY-MM-DD."
                      />
                    </div>
                  </div>

                  <div class="option-label">Schema (JSON)</div>
                  <textarea
                    id="structured-schema"
                    class="textarea"
                    rows="10"
                    spellcheck="false"
                    placeholder='{"type":"object","properties":{"document_title":{"type":"string"}}, "required":["document_title"]}'
                  ></textarea>
                </div>
              </div>
              <div class="input-card">
                <h3>Document A</h3>
                <p class="muted">Original version</p>
                <input id="left-file" name="left" type="file" required />
              </div>
              <div class="input-card">
                <h3>Document B</h3>
                <p class="muted">Revised version</p>
                <input id="right-file" name="right" type="file" required />
              </div>
              <div class="actions">
                <button type="submit" class="primary">Compare Documents</button>
                <button type="button" id="reset-btn" class="ghost">Reset</button>
              </div>
            </form>
          </section>

          <section id="status" class="status hidden" role="status" aria-live="polite"></section>

          <section class="results" id="results" data-has-results="false" aria-label="Comparison results">
            <div class="empty-state" id="empty-state">
              <h2>Results</h2>
              <p class="muted">
                Upload Document A and Document B, then click <strong>Compare Documents</strong> to
                generate a diff.
              </p>
            </div>

            <div class="results-grid" aria-hidden="false">
              <div class="summary card" id="summary">
                <div class="card-header">
                  <div>
                    <h2>Summary</h2>
                    <p class="muted">Quick stats for the extracted text diff.</p>
                  </div>
                </div>
                <div class="summary-grid">
                  <div class="stat">
                    <h3 id="summary-additions-label">Words added</h3>
                    <p id="summary-additions" class="summary-value">0</p>
                  </div>
                  <div class="stat">
                    <h3 id="summary-removals-label">Words removed</h3>
                    <p id="summary-removals" class="summary-value">0</p>
                  </div>
                  <div class="stat">
                    <h3 id="summary-total-label">Diff chunks</h3>
                    <p id="summary-total" class="summary-value">0</p>
                  </div>
                </div>
              </div>

              <div class="card" id="insights">
                <div class="card-header">
                  <div>
                    <h2>Insights</h2>
                    <p class="muted">What changed (numbers, dates, links, and more).</p>
                  </div>
                </div>
                <div class="insights-summary kv" id="insights-summary" aria-live="polite"></div>
                <div class="insights-grid">
                  <div class="insight">
                    <div class="insight-title">Added</div>
                    <div class="insight-list" id="insights-added"></div>
                  </div>
                  <div class="insight">
                    <div class="insight-title">Removed</div>
                    <div class="insight-list" id="insights-removed"></div>
                  </div>
                </div>
                <div class="insights-grid insights-grid-details">
                  <div class="insight">
                    <div class="insight-title">Categories</div>
                    <div class="insight-list" id="insights-categories"></div>
                  </div>
                  <div class="insight">
                    <div class="insight-title">Suggested checks</div>
                    <div class="insight-list" id="insights-checks"></div>
                  </div>
                </div>
                <div class="insights-grid insights-grid-details">
                  <div class="insight">
                    <div class="insight-title">Risks</div>
                    <div class="insight-list" id="insights-risks"></div>
                  </div>
                  <div class="insight">
                    <div class="insight-title">Confidence</div>
                    <div class="insight-list" id="insights-confidence"></div>
                  </div>
                </div>
              </div>

              <div class="card diff-card" id="inline">
                <div class="card-header">
                  <div>
                    <h2>Inline</h2>
                    <p class="muted">Combined view of additions and removals.</p>
                  </div>
                </div>
                <div id="diff-inline" class="diff-panel" aria-label="Inline diff"></div>
              </div>

              <div class="card diff-card" id="side-by-side">
                <div class="card-header">
                  <div>
                    <h2>Side-by-side</h2>
                    <p class="muted">Additions and removals highlighted per document.</p>
                  </div>
                </div>
                <div class="diff-grid">
                  <div>
                    <h3>Document A</h3>
                    <div id="diff-left" class="diff-panel" aria-label="Document A diff"></div>
                  </div>
                  <div>
                    <h3>Document B</h3>
                    <div id="diff-right" class="diff-panel" aria-label="Document B diff"></div>
                  </div>
                </div>
              </div>

              <details class="card" id="extracted">
                <summary>Extracted text</summary>
                <div class="diff-grid">
                  <pre id="extract-left" class="text-panel" aria-label="Extracted text for Document A"></pre>
                  <pre id="extract-right" class="text-panel" aria-label="Extracted text for Document B"></pre>
                </div>
              </details>

              <details class="card" id="structured">
                <summary>Structured output (optional)</summary>
                <div class="structured-diff">
                  <div class="structured-diff-header">
                    <div class="muted">Field-level changes from structured extraction (values only).</div>
                    <div class="pill" id="structured-diff-count">0 changes</div>
                  </div>
                  <div class="table" role="table" aria-label="Structured field differences">
                    <div class="table-head" role="row">
                      <div role="columnheader">Field</div>
                      <div role="columnheader">Document A</div>
                      <div role="columnheader">Document B</div>
                    </div>
                    <div class="table-body" id="structured-diff-rows" role="rowgroup"></div>
                  </div>
                </div>
                <div class="diff-grid">
                  <pre id="structured-left" class="text-panel" aria-label="Structured output for Document A"></pre>
                  <pre id="structured-right" class="text-panel" aria-label="Structured output for Document B"></pre>
                </div>
              </details>

            </div>
          </section>
        </div>

      </div>
    </main>

    <script src="app.js"></script>
  </body>
</html>
